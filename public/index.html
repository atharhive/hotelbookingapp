<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atharhive - Hotel Booking Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white">
    <!-- Navbar -->
    <header class="sticky top-0 z-50 bg-white dark:bg-gray-800 shadow-md">
        <nav class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-primary-500 rounded-lg flex items-center justify-center">
                        <i data-lucide="hotel" class="w-5 h-5 text-white"></i>
                    </div>
                    <span class="text-xl font-bold text-primary-600 dark:text-primary-400">Atharhive</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Home</a>
                    <a href="/hotels.html" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Hotels</a>
                    <a href="/my-bookings.html" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">My Bookings</a>
                    <a href="/contacts.html" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Contact</a>
                </div>

                <!-- Auth Buttons & Dark Mode Toggle -->
                <div class="hidden md:flex items-center space-x-4">
                    <button id="darkModeToggle" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i data-lucide="moon" class="w-5 h-5 dark:hidden"></i>
                        <i data-lucide="sun" class="w-5 h-5 hidden dark:block"></i>
                    </button>
                    <div id="authButtons">
                        <button onclick="showAuthModal('login')" class="px-4 py-2 text-primary-600 dark:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-lg transition-colors">Login</button>
                        <button onclick="showAuthModal('register')" class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors">Sign Up</button>
                    </div>
                    <div id="userMenu" class="hidden">
                        <div class="relative">
                            <button onclick="toggleUserDropdown()" class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                                <div class="w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center">
                                    <i data-lucide="user" class="w-4 h-4 text-white"></i>
                                </div>
                                <span id="userName" class="text-sm font-medium"></span>
                            </button>
                            <div id="userDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-700">
                                <a href="/my-bookings.html" class="block px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700">My Bookings</a>
                                <a href="#" onclick="logout()" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <button id="mobileMenuToggle" class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobileMenu" class="hidden md:hidden mt-4 pb-4 border-t dark:border-gray-700">
                <div class="flex flex-col space-y-4 pt-4">
                    <a href="/" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400">Home</a>
                    <a href="/hotels.html" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400">Hotels</a>
                    <a href="/my-bookings.html" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400">My Bookings</a>
                    <a href="/contacts.html" class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400">Contact</a>
                    <div id="mobileAuthButtons" class="flex items-center space-x-4 pt-4 border-t dark:border-gray-700">
                        <button onclick="showAuthModal('login')" class="px-4 py-2 text-primary-600 dark:text-primary-400 border border-primary-600 dark:border-primary-400 rounded-lg">Login</button>
                        <button onclick="showAuthModal('register')" class="px-4 py-2 bg-primary-600 text-white rounded-lg">Sign Up</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section with Search -->
    <section id="heroSection" class="relative bg-gradient-to-r from-primary-600 to-primary-700 dark:from-primary-700 dark:to-primary-800 py-16">
        <div class="absolute inset-0 bg-black/20"></div>
        <div class="relative container mx-auto px-4">
            <div class="text-center mb-8">
                <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Find Your Perfect Stay</h1>
                <p class="text-xl text-white/90">Discover amazing hotels at unbeatable prices</p>
            </div>

            <!-- Search Bar -->
            <div class="max-w-6xl mx-auto bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6">
                <form id="searchForm" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <!-- Location -->
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Location</label>
                        <div class="relative">
                            <i data-lucide="map-pin" class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <input type="text" id="location" placeholder="Where are you going?" class="w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
                        </div>
                    </div>

                    <!-- Check-in Date -->
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Check-in</label>
                        <div class="relative">
                            <i data-lucide="calendar" class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <input type="date" id="checkin" class="w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
                        </div>
                    </div>

                    <!-- Check-out Date -->
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Check-out</label>
                        <div class="relative">
                            <i data-lucide="calendar" class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <input type="date" id="checkout" class="w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
                        </div>
                    </div>

                    <!-- Guests -->
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Guests</label>
                        <div class="relative">
                            <i data-lucide="users" class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <select id="guests" class="w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white appearance-none">
                                <option value="1">1 Adult</option>
                                <option value="2">2 Adults</option>
                                <option value="3">3 Adults</option>
                                <option value="4">4 Adults</option>
                                <option value="5">5+ Adults</option>
                            </select>
                        </div>
                    </div>
                </form>

                <!-- Search Button -->
                <div class="mt-6 text-center">
                    <button onclick="searchHotels()" class="w-full md:w-auto px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-semibold text-lg">
                        <i data-lucide="search" class="inline w-5 h-5 mr-2"></i>
                        Search Hotels
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main id="mainContent" class="container mx-auto px-4 py-8">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Filters Sidebar -->
            <aside class="lg:w-80 flex-shrink-0">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sticky top-24">
                    <h3 class="text-lg font-semibold mb-6 flex items-center">
                        <i data-lucide="filter" class="w-5 h-5 mr-2"></i>
                        Filters
                    </h3>

                    <!-- Price Range -->
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Price Range (per night)</h4>
                        <div class="space-y-3">
                            <input type="range" id="priceRange" min="0" max="1000" value="500" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700" oninput="updatePriceValue()">
                            <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400">
                                <span>$0</span>
                                <span id="priceValue">$500</span>
                                <span>$1000+</span>
                            </div>
                        </div>
                    </div>

                    <!-- Star Rating -->
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Star Rating</h4>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" name="rating" value="5" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 flex items-center">
                                    <div class="flex text-yellow-400">
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                    </div>
                                    <span class="ml-2 text-sm">5 Stars</span>
                                </span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="rating" value="4" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 flex items-center">
                                    <div class="flex text-yellow-400">
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4"></i>
                                    </div>
                                    <span class="ml-2 text-sm">4+ Stars</span>
                                </span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="rating" value="3" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 flex items-center">
                                    <div class="flex text-yellow-400">
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                        <i data-lucide="star" class="w-4 h-4"></i>
                                        <i data-lucide="star" class="w-4 h-4"></i>
                                    </div>
                                    <span class="ml-2 text-sm">3+ Stars</span>
                                </span>
                            </label>
                        </div>
                    </div>

                    <!-- Room Type -->
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Room Type</h4>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" name="roomType" value="single" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Single Room</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="roomType" value="double" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Double Room</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="roomType" value="deluxe" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Deluxe Room</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="roomType" value="suite" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Suite</span>
                            </label>
                        </div>
                    </div>

                    <!-- Amenities -->
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Amenities</h4>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" name="amenities" value="WiFi" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Free WiFi</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="amenities" value="Pool" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Swimming Pool</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="amenities" value="AC" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Air Conditioning</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="amenities" value="Gym" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Fitness Center</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="amenities" value="Spa" onchange="applyFilters()" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                <span class="ml-2 text-sm">Spa</span>
                            </label>
                        </div>
                    </div>

                    <!-- Clear Filters -->
                    <button onclick="clearFilters()" class="w-full py-2 text-primary-600 dark:text-primary-400 border border-primary-600 dark:border-primary-400 rounded-lg hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors">
                        Clear All Filters
                    </button>
                </div>
            </aside>

            <!-- Hotel Listings -->
            <div class="flex-1">
                <!-- Results Header -->
                <div class="mb-6">
                    <h2 id="resultsTitle" class="text-2xl font-bold mb-2">Find Your Perfect Stay</h2>
                    <p id="resultsCount" class="text-gray-600 dark:text-gray-400">Search for hotels to see results</p>
                </div>

                <!-- Loading Spinner -->
                <div id="loadingSpinner" class="hidden text-center py-12">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div>
                    <p class="mt-2 text-gray-600 dark:text-gray-400">Loading hotels...</p>
                </div>

                <!-- No Results Message -->
                <div id="noResults" class="hidden text-center py-12">
                    <i data-lucide="search-x" class="w-16 h-16 mx-auto text-gray-400 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-600 dark:text-gray-400 mb-2">No Hotels Found</h3>
                    <p class="text-gray-500 dark:text-gray-500">Try adjusting your search criteria</p>
                </div>

                <!-- Hotel Grid -->
                <div id="hotelGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Hotels will be displayed here -->
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="space-y-4">
                    <div class="flex items-center space-x-2">
                        <i data-lucide="hotel" class="w-6 h-6 text-primary-400"></i>
                        <span class="text-xl font-bold text-primary-400">Atharhive</span>
                    </div>
                    <p class="text-gray-400">Your trusted partner for comfortable and memorable stays.</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="/" class="text-gray-400 hover:text-primary-400 transition">Home</a></li>
                        <li><a href="/hotels" class="text-gray-400 hover:text-primary-400 transition">Hotels</a></li>
                        <li><a href="/my-bookings" class="text-gray-400 hover:text-primary-400 transition">My Bookings</a></li>
                        <li><a href="/contacts" class="text-gray-400 hover:text-primary-400 transition">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Contact Us</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-center space-x-2">
                            <i data-lucide="mail" class="w-5 h-5"></i>
                            <span>support@atharhive.com</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <i data-lucide="phone" class="w-5 h-5"></i>
                            <span>+1 234 567 890</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <i data-lucide="map-pin" class="w-5 h-5"></i>
                            <span>123 Main St, New York, NY</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Follow Us</h3>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition">
                            <i data-lucide="facebook" class="w-6 h-6"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition">
                            <i data-lucide="twitter" class="w-6 h-6"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition">
                            <i data-lucide="instagram" class="w-6 h-6"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary-400 transition">
                            <i data-lucide="linkedin" class="w-6 h-6"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                <p>&copy; 2024 Atharhive. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 id="authModalTitle" class="text-2xl font-bold">Login</h2>
                    <button onclick="hideAuthModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>

                <form id="authForm">
                    <div id="nameField" class="mb-4 hidden">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Full Name</label>
                        <input type="text" id="name" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" placeholder="Enter your full name">
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email Address</label>
                        <input type="email" id="email" required class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" placeholder="Enter your email">
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Password</label>
                        <input type="password" id="password" required class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white" placeholder="Enter your password">
                    </div>

                    <button type="submit" class="w-full bg-primary-600 text-white py-3 rounded-lg hover:bg-primary-700 transition-colors font-semibold">
                        <span id="authSubmitText">Login</span>
                    </button>
                </form>

                <div class="mt-4 text-center">
                    <p class="text-sm text-gray-600 dark:text-gray-400">
                        <span id="authSwitchText">Don't have an account?</span>
                        <button id="authSwitchBtn" onclick="switchAuthMode()" class="text-primary-600 dark:text-primary-400 hover:underline font-medium">Sign up</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Container -->
    <div id="messageContainer" class="fixed bottom-4 right-4 z-50 space-y-2"></div>

    <script>
        // Global variables
        const API_URL = window.location.origin;
        let currentUser = null;
        let authToken = localStorage.getItem('authToken');
        let allHotels = [];
        let allRooms = [];
        let currentView = 'home';

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            lucide.createIcons();
            setupEventListeners();
            
            if (authToken) {
                // Validate token and get user info
                fetch(`${API_URL}/api/auth/me`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        currentUser = data.data.user;
                        updateAuthUI();
                    } else {
                        localStorage.removeItem('authToken');
                        authToken = null;
                    }
                })
                .catch(error => {
                    localStorage.removeItem('authToken');
                    authToken = null;
                });
            }
            
            loadHotels();
            setDefaultDates();
        }

        function setupEventListeners() {
            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
            
            // Mobile menu toggle
            document.getElementById('mobileMenuToggle').addEventListener('click', toggleMobileMenu);
            
            // Auth form
            document.getElementById('authForm').addEventListener('submit', handleAuth);
            
            // Price range slider
            document.getElementById('priceRange').addEventListener('input', updatePriceValue);
            
            // Search form
            document.getElementById('searchForm').addEventListener('submit', function(e) {
                e.preventDefault();
                searchHotels();
            });
        }

        function setDefaultDates() {
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            document.getElementById('checkin').value = today.toISOString().split('T')[0];
            document.getElementById('checkout').value = tomorrow.toISOString().split('T')[0];
        }

        // Auth functions
        function showAuthModal(mode) {
            const modal = document.getElementById('authModal');
            const title = document.getElementById('authModalTitle');
            const nameField = document.getElementById('nameField');
            const submitText = document.getElementById('authSubmitText');
            const switchText = document.getElementById('authSwitchText');
            const switchBtn = document.getElementById('authSwitchBtn');

            if (mode === 'register') {
                title.textContent = 'Sign Up';
                nameField.classList.remove('hidden');
                submitText.textContent = 'Sign Up';
                switchText.textContent = 'Already have an account?';
                switchBtn.textContent = 'Login';
                switchBtn.onclick = () => showAuthModal('login');
            } else {
                title.textContent = 'Login';
                nameField.classList.add('hidden');
                submitText.textContent = 'Login';
                switchText.textContent = "Don't have an account?";
                switchBtn.textContent = 'Sign up';
                switchBtn.onclick = () => showAuthModal('register');
            }

            modal.classList.remove('hidden');
            modal.dataset.mode = mode;
        }

        function hideAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('authForm').reset();
        }

        function switchAuthMode() {
            const modal = document.getElementById('authModal');
            const currentMode = modal.dataset.mode;
            showAuthModal(currentMode === 'login' ? 'register' : 'login');
        }

        async function handleAuth(e) {
            e.preventDefault();
            
            const mode = document.getElementById('authModal').dataset.mode;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const name = document.getElementById('name').value;

            const endpoint = mode === 'register' ? '/api/auth/register' : '/api/auth/login';
            const payload = mode === 'register' 
                ? { name, email, password }
                : { email, password };

            try {
                const response = await fetch(`${API_URL}${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (data.success) {
                    authToken = data.data.token;
                    currentUser = data.data.user;
                    localStorage.setItem('authToken', authToken);
                    
                    updateAuthUI();
                    hideAuthModal();
                    showMessage('success', mode === 'register' ? 'Account created successfully!' : 'Logged in successfully!');
                } else {
                    showMessage('error', data.message || 'Authentication failed');
                }
            } catch (error) {
                showMessage('error', 'Connection error. Please try again.');
            }
        }

        function updateAuthUI() {
            const authButtons = document.getElementById('authButtons');
            const userMenu = document.getElementById('userMenu');
            const userName = document.getElementById('userName');
            const mobileAuthButtons = document.getElementById('mobileAuthButtons');

            if (currentUser) {
                authButtons.classList.add('hidden');
                userMenu.classList.remove('hidden');
                userName.textContent = currentUser.name;
                mobileAuthButtons.classList.add('hidden');
            } else {
                authButtons.classList.remove('hidden');
                userMenu.classList.add('hidden');
                mobileAuthButtons.classList.remove('hidden');
            }
        }

        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('hidden');
        }

        function logout() {
            authToken = null;
            currentUser = null;
            localStorage.removeItem('authToken');
            updateAuthUI();
            showMessage('success', 'Logged out successfully');
        }

        // Hotel functions
        async function loadHotels() {
            try {
                showLoading(true);
                
                const [hotelsResponse, roomsResponse] = await Promise.all([
                    fetch(`${API_URL}/api/hotels`),
                    fetch(`${API_URL}/api/rooms`)
                ]);

                const hotelsData = await hotelsResponse.json();
                const roomsData = await roomsResponse.json();

                if (hotelsData.success && roomsData.success) {
                    allHotels = hotelsData.data.hotels;
                    allRooms = roomsData.data.rooms;
                    
                    // Associate rooms with hotels
                    allHotels.forEach(hotel => {
                        hotel.rooms = allRooms.filter(room => room.hotelId === hotel.id);
                    });
                    
                    displayHotels(allHotels);
                } else {
                    throw new Error('Failed to load hotels');
                }
            } catch (error) {
                showMessage('error', 'Failed to load hotels. Please try again.');
                showNoResults();
            } finally {
                showLoading(false);
            }
        }

        function displayHotels(hotels) {
            allHotels = hotels; // Store hotels for filtering
            const grid = document.getElementById('hotelGrid');
            
            if (hotels.length === 0) {
                showNoResults();
                return;
            }

            hideNoResults();
            document.getElementById('resultsCount').textContent = `Showing ${hotels.length} hotel${hotels.length !== 1 ? 's' : ''}`;

            grid.innerHTML = hotels.map(hotel => {
                const minPrice = hotel.rooms.length > 0 
                    ? Math.min(...hotel.rooms.map(room => parseFloat(room.pricePerNight || room.price)))
                    : 0;

                return `
                    <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden hover:shadow-xl hover:scale-[1.02] transition-all duration-300">
                        <div class="relative">
                            <img src="${hotel.images[0] || 'https://via.placeholder.com/400x300?text=No+Image'}" 
                                 alt="${hotel.name}" 
                                 class="w-full h-48 object-cover">
                            <div class="absolute top-4 right-4 bg-black/50 text-white px-2 py-1 rounded-lg text-sm">
                                <i data-lucide="heart" class="w-4 h-4"></i>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="text-xl font-semibold">${hotel.name}</h3>
                                <div class="flex text-yellow-400">
                                    ${Array.from({length: 5}, (_, i) => 
                                        `<i data-lucide="star" class="w-4 h-4 ${i < hotel.starRating ? 'fill-current' : ''}"></i>`
                                    ).join('')}
                                </div>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400 mb-3 flex items-center">
                                <i data-lucide="map-pin" class="w-4 h-4 mr-1"></i>
                                ${hotel.location}
                            </p>
                            <p class="text-gray-600 dark:text-gray-400 mb-4 text-sm">${hotel.description}</p>
                            <div class="flex flex-wrap gap-2 mb-4">
                                ${hotel.amenities.slice(0, 3).map(amenity => 
                                    `<span class="px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 rounded-full text-xs">${amenity}</span>`
                                ).join('')}
                                ${hotel.amenities.length > 3 ? `<span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full text-xs">+${hotel.amenities.length - 3} more</span>` : ''}
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <span class="text-2xl font-bold text-primary-600 dark:text-primary-400">${hotel.currency} ${minPrice || 'N/A'}</span>
                                    <span class="text-gray-600 dark:text-gray-400">/night</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="viewHotelDetails('${hotel.id}')" class="px-4 py-2 border border-primary-600 dark:border-primary-400 text-primary-600 dark:text-primary-400 rounded-lg hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors">
                                        View Details
                                    </button>
                                    ${hotel.rooms.length > 0 ? 
                                        `<button onclick="showBookingModal('${hotel.id}')" class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors">
                                            Book Now
                                        </button>` : 
                                        `<button disabled class="px-4 py-2 bg-gray-400 text-white rounded-lg cursor-not-allowed">
                                            No Rooms
                                        </button>`
                                    }
                                </div>
                            </div>
                        </div>
                    </article>
                `;
            }).join('');
            
            lucide.createIcons();
        }

        async function searchHotels() {
            const location = document.getElementById('location').value;
            const checkin = document.getElementById('checkin').value;
            const checkout = document.getElementById('checkout').value;
            const guests = document.getElementById('guests').value;

            if (!location || !checkin || !checkout) {
                showMessage('error', 'Please fill in all required fields');
                return;
            }

            try {
                showLoading(true);
                hideNoResults();

                const response = await fetch(`/api/hotels/search?location=${encodeURIComponent(location)}&checkin=${checkin}&checkout=${checkout}&adults=${guests}`);
                const data = await response.json();

                if (!data.success) {
                    throw new Error(data.message);
                }

                const { hotels, destination } = data.data;
                
                if (hotels.length === 0) {
                    showNoResults();
                    return;
                }

                displayHotels(hotels);
                document.getElementById('resultsTitle').textContent = `Hotels in ${destination.name}, ${destination.country}`;
                document.getElementById('resultsCount').textContent = `Showing ${hotels.length} hotel${hotels.length !== 1 ? 's' : ''}`;
            } catch (error) {
                console.error('Error searching hotels:', error);
                showMessage('error', error.message || 'Error searching hotels');
                showNoResults();
            } finally {
                showLoading(false);
            }
        }

        function applyFilters() {
            const maxPrice = parseInt(document.getElementById('priceRange').value);
            const selectedRatings = Array.from(document.querySelectorAll('input[name="rating"]:checked')).map(cb => parseInt(cb.value));
            const selectedRoomTypes = Array.from(document.querySelectorAll('input[name="roomType"]:checked')).map(cb => cb.value);
            const selectedAmenities = Array.from(document.querySelectorAll('input[name="amenities"]:checked')).map(cb => cb.value);
            const sortBy = document.getElementById('sortBy').value;

            let filteredHotels = allHotels.filter(hotel => {
                // Price filter
                const minPrice = hotel.rooms.length > 0 
                    ? Math.min(...hotel.rooms.map(room => parseFloat(room.pricePerNight || room.price)))
                    : 0;
                if (minPrice > maxPrice) return false;

                // Rating filter
                if (selectedRatings.length > 0 && !selectedRatings.includes(hotel.starRating)) return false;

                // Room type filter
                if (selectedRoomTypes.length > 0) {
                    const hasMatchingRoom = hotel.rooms.some(room => selectedRoomTypes.includes(room.roomType));
                    if (!hasMatchingRoom) return false;
                }

                // Amenities filter
                if (selectedAmenities.length > 0) {
                    const hasMatchingAmenity = selectedAmenities.some(amenity => hotel.amenities.includes(amenity));
                    if (!hasMatchingAmenity) return false;
                }

                return true;
            });

            // Sort hotels
            switch (sortBy) {
                case 'price_low':
                    filteredHotels.sort((a, b) => {
                        const priceA = a.rooms.length > 0 ? Math.min(...a.rooms.map(r => parseFloat(r.pricePerNight || r.price))) : 0;
                        const priceB = b.rooms.length > 0 ? Math.min(...b.rooms.map(r => parseFloat(r.pricePerNight || r.price))) : 0;
                        return priceA - priceB;
                    });
                    break;
                case 'price_high':
                    filteredHotels.sort((a, b) => {
                        const priceA = a.rooms.length > 0 ? Math.min(...a.rooms.map(r => parseFloat(r.pricePerNight || r.price))) : 0;
                        const priceB = b.rooms.length > 0 ? Math.min(...b.rooms.map(r => parseFloat(r.pricePerNight || r.price))) : 0;
                        return priceB - priceA;
                    });
                    break;
                case 'rating':
                    filteredHotels.sort((a, b) => b.starRating - a.starRating);
                    break;
            }

            displayHotels(filteredHotels);
        }

        function clearFilters() {
            // Reset all form inputs
            document.getElementById('priceRange').value = 500;
            updatePriceValue();
            
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('sortBy').value = 'recommended';
            
            displayHotels(allHotels);
        }

        function updatePriceValue() {
            const value = document.getElementById('priceRange').value;
            document.getElementById('priceValue').textContent = `$${value}`;
        }

        // Utility functions
        function showLoading(show) {
            const spinner = document.getElementById('loadingSpinner');
            const grid = document.getElementById('hotelGrid');
            
            if (show) {
                spinner.classList.remove('hidden');
                grid.classList.add('hidden');
            } else {
                spinner.classList.add('hidden');
                grid.classList.remove('hidden');
            }
        }

        function showNoResults() {
            document.getElementById('noResults').classList.remove('hidden');
            document.getElementById('hotelGrid').classList.add('hidden');
        }

        function hideNoResults() {
            document.getElementById('noResults').classList.add('hidden');
            document.getElementById('hotelGrid').classList.remove('hidden');
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
        }

        function showMessage(type, message) {
            const container = document.getElementById('messageContainer');
            const id = Date.now();
            
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };

            const messageEl = document.createElement('div');
            messageEl.id = `message-${id}`;
            messageEl.className = `${colors[type]} text-white px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full`;
            messageEl.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="removeMessage(${id})" class="ml-4 text-white/80 hover:text-white">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                </div>
            `;

            container.appendChild(messageEl);
            lucide.createIcons();

            // Animate in
            setTimeout(() => {
                messageEl.classList.remove('translate-x-full');
            }, 100);

            // Auto remove after 5 seconds
            setTimeout(() => {
                removeMessage(id);
            }, 5000);
        }

        function removeMessage(id) {
            const messageEl = document.getElementById(`message-${id}`);
            if (messageEl) {
                messageEl.classList.add('translate-x-full');
                setTimeout(() => {
                    messageEl.remove();
                }, 300);
            }
        }

        // Load dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }
    </script>
</body>
</html>